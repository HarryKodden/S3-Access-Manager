server:
  host: "0.0.0.0"
  port: 9000
  read_timeout: 30s
  write_timeout: 30s

# Tenant Configuration (Multi-Tenant Setup)
# ===========================================
# If tenant is specified, tenant-specific config will be loaded from ./data/<tenant>/config.yaml
# This enables complete isolation between tenants (users, groups, policies, credentials, OIDC)
# tenant:
#   name: "my-tenant"  # Tenant identifier (used in URLs: /tenant/my-tenant/...)
#   data_dir: "./data/my-tenant"  # Optional, defaults to ./data/<name>

# Global OIDC Configuration (Single-Tenant or Fallback)
# ======================================================
# For single-tenant deployments, configure OIDC here
# For multi-tenant deployments, OIDC config moves to ./data/<tenant>/config.yaml
oidc:
  # Your OIDC provider's issuer URL
  # RECOMMENDED: Set via OIDC_ISSUER environment variable
  issuer: ""

  # Client credentials
  # SECURITY: Set these via environment variables instead:
  #   OIDC_CLIENT_ID
  #   OIDC_CLIENT_SECRET
  client_id: ""
  client_secret: ""

  # OIDC scopes to request
  # Default: "openid profile email eduPersonEntitlement"
  # Set via OIDC_SCOPES environment variable
  scopes: "openid profile email eduPersonEntitlement"

  # The claim in the JWT that contains role names
  groups_claim: "groups"

  # Optional: Additional claims to extract for logging
  user_claim: "sub"
  email_claim: "email"

  # Session cache TTL - how long to cache user info before revalidating with OIDC provider
  # Default: 15m (15 minutes)
  # Set via OIDC_SESSION_CACHE_TTL environment variable (e.g., "10m", "30m", "1h")
  # After this time, the access token is revalidated via the userinfo endpoint
  # If validation succeeds, the session cache is extended by this duration
  session_cache_ttl: 15m

s3:
  # S3 endpoint (use https://s3.amazonaws.com for AWS S3)
  # RECOMMENDED: Set via S3_ENDPOINT environment variable
  endpoint: ""

  # AWS region
  # RECOMMENDED: Set via S3_REGION or AWS_REGION environment variable
  region: ""

  # Backend: Always uses AWS CLI for user/credential management

  # Optional: Custom S3-compatible storage (MinIO, Wasabi, etc.)
  # Set via S3_FORCE_PATH_STYLE environment variable
  force_path_style: false

# IAM credentials are configured per tenant in ./data/<tenant>/config.yaml
# Each tenant requires its own IAM access key and secret key for AWS operations

policies:
  # Directory containing policy JSON files (admin-created policies only)
  directory: "./data/policies"

  # Default policy when no roles match
  default_deny: true

  # Cache policies in memory (improves performance)
  cache_enabled: true
  cache_ttl: 300s

# Roles Configuration (backend API uses /settings/roles)
roles:
  # Directory where role files are stored (SCIM Group -> Role -> IAM Group mapping)
  directory: "./data/roles"

# SCIM Configuration
users:
  # Directory for SCIM user data
  directory: "./data/scim/Users"

groups:
  # Directory for SCIM group data (candidate groups for policy assignment)
  directory: "./data/scim/Groups"

# SCIM Server Configuration
# =========================
# Settings for the external SCIM server used for user/group provisioning
# For multi-tenant setups, this moves to ./data/<tenant>/config.yaml
scim:
  # API key for authenticating with the SCIM server
  # RECOMMENDED: Set via SCIM_API_KEY environment variable
  api_key: ""

# SRAM Configuration (SURF Research Access Management)
# ====================================================
# SRAM integration for collaboration and invitation management
sram:
  # SRAM API base URL
  # Use https://acc.sram.surf.nl for testing/acceptance
  # Use https://sram.surf.nl for production
  # RECOMMENDED: Set via SRAM_API_URL environment variable
  api_url: "https://acc.sram.surf.nl"

  # SRAM API key for authentication
  # SECURITY: Set via SRAM_API_KEY environment variable
  api_key: ""

  # Enable/disable SRAM integration
  # Set via SRAM_ENABLED environment variable (true/false)
  enabled: false

# Global Administrators
# Email addresses of users with full system administration privileges
# These users can manage all tenants, global configuration, and perform any operation
# RECOMMENDED: Set via GLOBAL_ADMINS environment variable (comma-separated)
global_admins:
  # - "admin@example.com"
  # - "superadmin@company.com"

logging:
  # Log level: debug, info, warn, error
  level: "info"

  # Log format: json, text
  format: "json"

  # Log file path (empty for stdout only)
  file: ""

  # Enable access logging
  access_log: true

  # Log S3 operations
  audit_log: true

security:
  # Enable request signature validation
  validate_signatures: true

  # Allowed HTTP methods
  allowed_methods:
  - GET
  - PUT
  - POST
  - DELETE
  - HEAD
  # Enable CORS
  cors_enabled: true
  cors_origins:
  - "*"
  # Rate limiting (requests per minute per user)
  rate_limit: 1000

monitoring:
  # Enable Prometheus metrics endpoint
  metrics_enabled: true
  metrics_port: 9090
